function [ x, S, r ]=ThMP( A,b,options )
%
% input: A normalized!

min_err=options.min_error;


b0=b;

[~,m]=size(A);
S=zeros(m,1);
x=zeros(m,1);
k=1;
while norm(b) > min_err
    coefs=A'*b;
    [coef,ind]=max(coefs); % assuming only one max exists
    S(ind)=1;
    b=b-coef*A(ind);
    x(ind)=coef;
end
r=norm(b)/norm(b0);

end

