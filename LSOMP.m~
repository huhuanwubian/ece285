function [ x, S, r ]=OMP( A,b,options )
%
% input: A normalized!

min_err=options.min_error;
b0=b;
[n,m]=size(A);
S=zeros(m,1);
x=zeros(m,1);
%Q=zeros(n,m); % TODO: implicit Q of QR

while norm(b) > min_err
    
    min_normb=inf;
    min_i=0;
    min
    I=1:m;
    I=I(1-S);
    for i=I
        tA=A(:,[S;i]);
        tx=A\b;
        if (norm(b-tA*tx)<min_b)
            min_i=i;
            min_b=norm(b-tA*tx);
        end
    end
    
    b=b-tA*tx;
    x(1:iter)=x1;
    iter=iter+1;
end
r=norm(b)/norm(b0);
S=S(1:iter-1);
x=x(1:iter-1);
end

